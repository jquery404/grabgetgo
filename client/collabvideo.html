<html>
  <head>
    <meta charset="utf-8">
    <title>MERE - Collab Zone</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MERE - Collab Zone">


    <script src="scripts/af/aframe@1.2.0.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/easyrtc/easyrtc.js"></script>
    <script src="scripts/af/networked-aframe@0.8.2.min.js"></script>
    <script src="scripts/af/aframe-randomizer-components.min.js"></script>
    <script src="../jsvr/aframe-ui-widgets.js"></script>
    <script src="../jsvr/TubePainter.js"></script>
    <script src="../jsvr/af.components.js"></script>

</head>

<body>
  
    <body>
        <a-scene networked-scene="
          room: dev;
          debug: true;
          adapter: wseasyrtc;
        ">
          <a-assets>
    
            <img id="grid" src="../img/gfx/grid.png" />
            <img id="sky" src="../img/gfx/sky.jpg" />
    
            <a-asset-item id="boy-head-glb" src="../model/curious_boy_head_5.glb"></a-asset-item>
            <a-asset-item id="boy-body-glb" src="../model/curious_boy_body_5.glb"></a-asset-item>

            <!-- Templates -->

            <!-- Player -->
            <template id="player-template">
              <a-entity></a-entity>
            </template>

            <!-- Avatar -->
            <template id="avatar-template">
              <a-entity class="avatar">
                <a-entity class="nametag" text="value: Hello; align:center;" position="0 0.6 0" rotation="0 180 0" scale="4 4 4"></a-entity>
                <a-entity class="cartoon" gltf-model="#boy-head-glb" scale="1 1 1"></a-entity>
                <a-entity class="cartoon-body" gltf-model="#boy-body-glb" scale="1 1 1"></a-entity>
              </a-entity>
            </template>

            <!-- Body -->
            <template id="body-template">
              <a-entity class="cartoon-body" gltf-model="#boy-body-glb" scale="1 1 1"></a-entity>
            </template>
    
            <!-- /Templates -->
          </a-assets>
    
          <a-entity id="player" networked="template:#avatar-template;attachTemplateToLocal:false;" camera position="0 1.6 0" spawn-in-circle="radius:3" wasd-controls look-controls>
            <a-sphere class="head" visible="false"></a-sphere>
          </a-entity>
    
          <a-entity position="0 0 0"
            geometry="primitive: plane; width: 10000; height: 10000;" rotation="-90 0 0"
            material="src: #grid; repeat: 10000 10000; transparent: true; metalness:0.6; roughness: 0.4; sphericalEnvMap: #sky;"></a-entity>
    
          <a-entity light="color: #ccccff; intensity: 1; type: ambient;" visible=""></a-entity>
          <a-entity light="color: #ffaaff; intensity: 1.5" position="5 5 5"></a-entity>
    
          <a-sky src="#sky" rotation="0 -90 0"></a-sky>
          <a-entity id="particles" particle-system="preset: snow"></a-entity>
        </a-scene>
    
        
        <script>
          // On mobile remove elements that are resource heavy
          var isMobile = AFRAME.utils.device.isMobile();
    
          if (isMobile) {
            var particles = document.getElementById('particles');
            particles.parentNode.removeChild(particles);
          }
        </script>
    
        <script>
          // Define custom schema for syncing avatar color, set by random-color
          // NAF.schemas.add({
          //   template: '#avatar-template',
          //   components: [
          //     'position',
          //     'rotation',
          //     {
          //       selector: '.head',
          //       component: 'material',
          //       property: 'color'
          //     }
          //   ]
          // });
    
          // Called by Networked-Aframe when connected to server
          function onConnect () {
            console.log("onConnect", new Date());
          }
        </script>
      </body>
</html>